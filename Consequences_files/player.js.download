const debug=!1,info=(...e)=>console.log(...e),log=(...e)=>false,error=(...e)=>false,element=e=>document.querySelector(e);info("▶️ v1.0.99");const API="https://api.bitchute.com/api/beta9",bitchuteAPI="https://api.bitchute.com/api/beta",bitchuteServer="https://www.bitchute.com",playAdsOverDuration=30,controlBarLogo="https://static-files.bitchute.com/player/icons/favicon-96x96.png";let related_videos=[],upNextSet=!1;const streamOfflineImage=bitchuteServer+"/static/stream-offline.jpeg",STORAGE_VIDEO_MUTED="video_muted",STORAGE_VIDEO_VOLUME="video_volume",STORAGE_VIDEO_SPEED="video_speed",STORAGE_AD_ERROR_TIMESTAMP="ad_error_timestamp",TWELVE_HOURS_IN_SECONDS=300;let canShowAd=!0,resumed=!1;const allowedOrigins=[bitchuteServer,"https://cd01.bitchute.com","https://old.bitchute.com","https://cd05.bitchute.com"],message=e=>{allowedOrigins.forEach((t=>{try{window.parent.postMessage(e,t)}catch(e){}}))},video=document.getElementById("player_one");log(thumbnail_url);const isFirefox=navigator.userAgent.toLowerCase().includes("firefox"),urlParams=new URLSearchParams(window.location.search),duration=urlParams.get("duration");let showAds="true"===(urlParams.get("showAds")?.toLowerCase?.()||"true");function isBrave(){return null!=window.navigator.brave&&"isBrave"==window.navigator.brave.isBrave.name}function detectUBlock(){const e=new Image;e.src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js",e.onerror=()=>!0,e.onload=()=>!1}var braveLocked=!1;media_url.includes("video.m3u8")&&(state_id="live");var ADS_URL="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js";function checkAdsBlocked(e){var t=new XMLHttpRequest;t.onreadystatechange=function(){t.readyState==XMLHttpRequest.DONE&&e(0===t.status||t.responseURL!==ADS_URL)},t.open("HEAD",ADS_URL,!0),t.send(null)}const isLive="live"===state_id;function allowAds(){try{const e=localStorage.getItem("account_setting");if(e){const t=e.replace(/^__q_objt\|/,""),o=JSON.parse(t),a=o?.allow_adverts;return"boolean"!=typeof a||a}return error(),!0}catch(e){return error(e.message),!0}}function showBigRedButton(){if(!isPhone){element(".vjs-big-play-button").style.opacity="1"}}function hideBigRedButton(){if(!isPhone){element(".vjs-big-play-button").style.opacity="0"}}function isIpad(){const e=navigator.userAgent||navigator.vendor||window.opera;return!!/iPad/.test(e)||!!(/Macintosh/.test(e)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>1)}checkAdsBlocked((function(e){"undefined"==typeof google&&(allowAds()||showAds)||e&&!isBrave()&&!isFirefox&&allowAds()&&!isIpad()&&showAds?(localStorage.setItem("sponblo"+video_id,String(!0)),info("[❌] SponBlocked"),message("SPON_BLOCKED")):isBrave()&&allowAds()&&showAds&&!isLive?(braveLocked=!0,localStorage.setItem("sponblo"+video_id,String(!0)),info("[❌] SponBlocked"),message("SPON_BLOCKED")):info("[📢] SponNotBlocked")}));var isPhone=(()=>{log(navigator.userAgent);const e=/iPhone|iPod|Android.*Mobile|Windows Phone|BlackBerry|Opera Mini|IEMobile/.test(navigator.userAgent),t=navigator.maxTouchPoints>=1;return e||navigator.userAgent.includes("Macintosh")&&t})();async function fetchSuggested(){try{const e=API+"/videos",t={selection:"suggested",offset:1,limit:20,advertisable:!0},o=await fetch(e,{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify(t)});if(200===o.status)return await o.json()}catch(e){e("Error fetching suggested videos:",e)}}async function getVideoData(e){try{const t=bitchuteAPI+"/video",o={video_id:e},a=await fetch(t,{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify(o)});if(200===a.status)return await a.json()}catch(e){e("Error fetching suggested videos:",e)}}function isDurationOverThreeMinutes(e){const t=e.split(":");return 60*parseInt(t[0],10)+parseInt(t[1],10)>180}function loadImage(e){return new Promise(((t,o)=>{const a=new Image;a.src=e,a.onload=()=>t(a),a.onerror=()=>o(new Error("Image failed to load"))}))}async function processThumbnail(e){if(e){const t=e;if(e.includes("320x180")){const o=e=e.replace("320x180","640x360");try{await loadImage(o),log(),log()}catch(o){e=t,log(),log()}}}else e="https://static-files.bitchute.com/player/icons/favicon-96x96.png";return log(),e}window.onload=async()=>{const e=new URLSearchParams(window.location.search),t=parseInt(e.get("startTime"))||0,o="true"===(e.get("autoPlay")||"false").toLowerCase(),a="true"===(e.get("theaterMode")||"true").toLowerCase(),n=(e.get("duration")||"0").toLowerCase(),i="true"===(e.get("embedMode")||"true").toLowerCase();let r,s=Number(localStorage.getItem("video_volume")||1),l=Number(!isLive&&localStorage.getItem("video_speed")||1);thumbnail_url=await processThumbnail(thumbnail_url),log(video_id),log(),log(),log(),log(state_id),log(media_url),log();try{const[e,t]=n.split(":").map(Number);r=60*e+t}catch{log()}let d=null;r>0&&r<180?log():(log(),d=await fetchSuggested()),d&&(d=d.videos,related_videos=d.map((e=>({thumb:e.thumbnail_url,url:bitchuteServer+`/video/${e.video_id}`,title:e.video_name,duration:e.duration}))));let c=!0,u="video/mp4";isLive&&(u="application/x-mpegURL",c=!1),log();let g=!1;const m={playbackRates:[.25,.5,.75,1,1.25,1.5,1.75,2,2.25,2.5,3,4],controls:!0,aspectRatio:"16:9",preload:"auto",responsive:!0,playsinline:!0,techOrder:["chromecast","html5"],poster:thumbnail_url,startTime:Number(t),sources:[{src:media_url,type:u}]},v={shareMenu:!1,theaterButton:a,logourl:bitchuteServer,logocontrolbar:controlBarLogo,contextMenu:!1,title:video_name,url:bitchuteServer+"/video/"+video_id,controlbar:!0,endAction:"related",pipButton:!0,related:related_videos,target:"_blank",downloadButton:c,video_id:video_id,resume:!0},p=videojs("player_one",m);if(log(p.muted()),p.nuevo(v),i){let e=`\n  <div style="display: flex; justify-content: space-between;align-items: center; ">\n    <a target="_blank" href="${bitchuteServer}/video/${video_id}" style="display: inline-block;position: relative;text-decoration: none;white-space: nowrap; overflow: hidden;text-overflow: ellipsis; color: #fff;">\n      <span style="font-weight: 700; font-size: 1.2em;">${video_name}</span>\n    </a>\n    <a target="_blank" href="${bitchuteServer}">\n    <span>\n      <svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" version="1.1" width="140.6" height="30" viewBox="0 0 220.6 50">\n        \x3c!-- Generator: Adobe Illustrator 29.0.1, SVG Export Plug-In . SVG Version: 2.1.0 Build 192)  --\x3e\n        <defs>\n          <style>\n            .st0 {\n            fill: #ef4137;\n            }\n\n            .st1 {\n            fill: #fff;\n            }\n\n            .st2 {\n            fill: #211f22;\n            }\n          </style>\n        </defs>\n        <rect class="st2" x="3.5" y="7.5" width="62.7" height="35" transform="translate(-5.3 9.9) rotate(-15)"/>\n        <polygon class="st0" points="131.1 20.7 115.9 20.7 115.9 7.3 107.8 7.3 107.8 42.1 115.9 42.1 115.9 27.8 131.1 27.8 131.1 42.1 139.2 42.1 139.2 7.3 131.1 7.3 131.1 20.7"/>\n        <path class="st0" d="M171.1,38.7"/>\n        <path class="st0" d="M164.7,27.9c0,2.3-.6,4.2-1.9,5.5s-3.2,2-5.5,2-4.3-.7-5.6-2-2-3.2-2-5.5V7.3h-8.2v20.8c0,4.4,1.4,8,4,10.6s6.6,4,11.7,4,9.1-1.3,11.7-4,4-6.2,4-10.6V7.3h-8.2v20.5Z"/>\n        <polygon class="st0" points="175.4 14.5 185.3 14.5 185.3 42.1 193.4 42.1 193.4 14.5 203.3 14.5 203.3 7.3 175.4 7.3 175.4 14.5"/>\n        <polygon class="st0" points="230.6 14.5 230.6 7.3 205.8 7.3 205.8 42.1 230.6 42.1 230.6 34.9 213.8 34.9 213.8 28 230.3 28 230.3 20.8 213.8 20.8 213.8 14.5 230.6 14.5"/>\n        <path class="st0" d="M97.8,26.1c-.7,5.4-5.7,9.2-11.1,8.5-2.6-.3-4.9-1.7-6.5-3.8l-7.7,2.1c4.5,8.6,15.1,11.9,23.6,7.4,6-3.1,9.7-9.5,9.4-16.2l-7.7,2.1Z"/>\n        <path class="st0" d="M87,7.3c-9.7.5-17.1,8.8-16.6,18.4.2,2.5.8,4.9,2,7.2l6.1-5c-1.7-5.2,1-10.8,6.2-12.5,2.7-.9,5.7-.6,8.2.8l6.1-5c-3.3-2.8-7.6-4.2-11.9-3.9Z"/>\n        <path class="st1" d="M25.9,41.6l-14.5,3.9-7.2-26.8,14.1-3.8c2.4-.6,4.5-.5,6.2.5,1.7.9,2.9,2.5,3.3,4.3.5,1.5.3,3-.2,4.4-.5,1.3-1.5,2.3-2.7,2.9,1.5-.2,3,.3,4.2,1.2,1.3,1,2.3,2.4,2.6,4,.6,1.9.4,4-.6,5.7-1,1.8-2.7,3-5.2,3.6ZM19.9,25.9c.8-.2,1.6-.7,2.1-1.4.8-1.4.3-3.2-1.1-4.1-.8-.4-1.7-.5-2.5-.2l-7.1,1.9,1.5,5.6,7.1-1.9ZM23.1,37c.9-.2,1.7-.7,2.3-1.5.5-.8.6-1.7.3-2.5-.2-.8-.8-1.5-1.5-2-.9-.4-1.8-.5-2.7-.2l-7.4,2,1.6,6.1,7.4-2Z"/>\n        <path class="st1" d="M41.7,37.4l-5.7,1.5-7.2-26.8,5.7-1.5,7.2,26.8Z"/>\n        <path class="st1" d="M57.3,33.2l-5.7,1.5-5.8-21.7-7.8,2.1-1.4-5,21.3-5.7,1.4,5-7.8,2.1,5.8,21.7Z"/>\n      </svg>\n    </span>\n  </a>\n  </div>\n  `;isPhone&&(e=`\n    <div style="display: flex; justify-content: space-between;align-items: center; ">\n      <a target="_blank" href="${bitchuteServer}/video/${video_id}" style="display: inline-block;position: relative;text-decoration: none;white-space: nowrap; overflow: hidden;text-overflow: ellipsis; color: #fff;">\n        <span style="font-weight: 700; font-size: 1.2em;">${video_name}</span>\n      </a>\n    </div>\n    `),p.overlay({overlays:[{content:e,align:"top-left",start:"playing"}]})}function h(){return null!=document.pictureInPictureElement||isFirefoxPiP}p.volume(s),p.playbackRate(l),isFirefoxPiP=void 0,isFirefox&&(isFirefoxPiP=!1,p.el().addEventListener("MozTogglePictureInPicture",(()=>{isFirefoxPiP=!0}))),isLive&&p.offline({offlineImage:streamOfflineImage,offlineTimeout:20,offlineCountdown:!0,label:"Checking for stream in "}),p.bigPlayButton.show();const f=element("#player_one > div.vjs-grid > p");f&&f.remove();const y=element(".vjs-grid");y&&(y.style.opacity="0.9"),p.chromecast({metaTitle:video_name,metaThumbnail:thumbnail_url,trackColor:"#FFCC00FF",trackBackground:"#000000FF",tracksEdgeType:"NONE",trackScale:.8,trackFont:"SERIF",trackStyle:"ITALIC",ui:"fixed",overlayButton:!0}),p.hotkeys({volumeStep:.1,seekStep:5});var T=!1;if(showAds){let e={};e=isPhone?{disableAdControls:!0,id:Date.now()+Math.floor(999999*Math.random())}:{id:Date.now()+Math.floor(999999*Math.random())},"undefined"!=typeof google&&p.ima(e)}var _=!1;o&&p.ready((()=>{canAutoplay.video().then((e=>{e.result&&setTimeout((()=>{var e=p.play();void 0!==e?e.then((()=>{_=!1})).catch((e=>{log(),_=!0})):log()}))}))})),p.on("ready",(()=>{document.querySelectorAll("[class^='vjs-']").forEach((e=>{e.addEventListener("click",(e=>{const t=e.currentTarget;setTimeout((()=>{t.blur(),window.parent.focus()}),250)}))}))}));const E=function(e=28){return[...Array(e)].map((()=>Math.random().toString(36)[2])).join("")}(),w=localStorage.getItem("xServiceInfo")||null;function S(e){log(video_id),fetch(API+"/wt/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({watchtime:e,video_id:video_id,play_id:E,xsi:w,timestamp:Date.now()})})}let A=p.currentTime(),I=null,b=p.currentTime(),P=A+60;p.on("play",(()=>{if(D){const e=element(".vjs-menu-div");if(e&&(e.style.maxHeight=""),isLive){const e=element(".vjs-cog-menu-button");e&&e.addEventListener("click",(()=>{const e=element(".vjs-extend-speed");e.style.cssText="color: #888; pointer-events: none; cursor: auto",e.classList.remove("vjs-menu-forward")}))}}S(A),I=setInterval((()=>{const e=p.currentTime();b<e&&(A++,A>=P&&(S(A),P+=60)),b=e}),1e3)})),p.on("pause",(()=>{I=clearInterval(I)}));const L={10:{event:"Video TENPERCENT",sent:!1},25:{event:"Video TWENTYFIVEPERCENT",sent:!1},50:{event:"Video FIFTYPERCENT",sent:!1},75:{event:"Video SEVENTYFIVEPERCENT",sent:!1},90:{event:"Video NINTYPERCENT",sent:!1}};let R=!1;p.on("timeupdate",(()=>{const e=p.currentTime(),t=p.duration(),o=Math.round(e/t*100);let a=parseInt(localStorage.getItem("ad_error_timestamp"),10);(isNaN(a)||null===a)&&(a=!1);const n=Math.floor((new Date).getTime()/1e3);canShowAd||(a&&n-a>300?(localStorage.setItem("ad_error_timestamp",null),canShowAd=!0):canShowAd=!1);const i=localStorage.getItem("vjs_resume-"+video_id);if(null==i||i<=422&&showAds&&canShowAd&&p.duration()>=600&&e>=422&&!R)try{if("undefined"==typeof google||isBrave())isBrave()?message("SPON_BLOCKED_MIDDLE"):(message("SPON_BLOCKED_MIDDLE"),log());else{const e=p.currentTime();h()&&message("SCROLL_TOP"),p.ima.initializeAdDisplayContainer(),p.ima.setContentWithAdTag(null,vastTagMidURL),p.ima.requestAds(),p.currentTime(e),hideBigRedButton()}R=!0}catch(e){error(),R=!0}if(L[o]){const e=L[o];e.sent||(e.sent=!0,e.event)}})),p.on("volumechange",(()=>{p.muted()&&localStorage.setItem("video_muted","true"),localStorage.setItem("video_volume",(s=p.volume()).toString())})),p.on("ratechange",(()=>{isLive||localStorage.setItem("video_speed",(l=p.playbackRate()).toString())})),p.on("error",(e=>{log()})),p.on("downloadVideo",((e,t)=>{c&&window.open(media_url,"_blank").focus()})),p.on("ads-manager",(e=>{log(),e.adsManager.addEventListener(google.ima.AdEvent.Type.LOADED,(()=>{T=!0,log()})),e.adsManager.addEventListener(google.ima.AdEvent.Type.STARTED,(()=>{T=!0,log()})),e.adsManager.addEventListener(google.ima.AdEvent.Type.IMPRESSION,(()=>{log()})),e.adsManager.addEventListener(google.ima.AdEvent.Type.COMPLETE,(()=>{T=!1,log(),log()})),e.adsManager.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,(()=>{T=!1;const e=window.videoStartTime||localStorage.getItem("vjs_resume-"+video_id);e&&(resumed=!0,p.currentTime(e),p.play(),p.pause(),p.play(),hideBigRedButton(),videoStartTime=0),p.play(),hideBigRedButton(),window.parent.focus(),R&&h()&&message("RESTORE_SCROLL"),log()}))}));let D=!0;p.on("play",(()=>{let e=localStorage.getItem("vjs_resume-"+video_id);null==e&&(e=0,localStorage.setItem("vjs_resume-"+video_id,0)),resumed||null===e||(resumed=!0,setTimeout((()=>p.currentTime(e))));try{showAds&&void 0!==p.ima&&D&&(D=!1,p.ima.initializeAdDisplayContainer(),p.ima.setContentWithAdTag(null,vastTagURL),p.ima.requestAds())}catch(e){error()}message("VIDEO_STARTED"),g||(g=!0),hideBigRedButton(),sessionStorage.setItem("interactedWithSite","true")})),p.on("pause",(()=>{log(),showBigRedButton(),message("VIDEO_PAUSED")})),p.on("mode",((e,t)=>{message("large"==t?"THEATER_LARGE":"THEATER_NORMAL")})),p.on("volumechange",(()=>{log(p.volume())})),p.on("chromecastConnected",(()=>{log()})),p.on("chromecastDisconnected",(()=>{log()})),p.on("ended",(()=>{localStorage.setItem("vjs_resume-"+video_id,0),message("VIDEO_ENDED"),upNextSet||p.related();const e=element("#player_one > div.vjs-grid > p");e&&e.remove();const t=element(".vjs-grid");t&&(t.style.opacity="0.9"),setTimeout((()=>{}),5e3)})),p.on("ads-manager",(e=>{const{adsManager:t}=e;t.addEventListener(google.ima.AdEvent.Type.LOADED,(()=>{})),t.addEventListener(google.ima.AdEvent.Type.STARTED,(()=>{message("AD_START")})),t.addEventListener(google.ima.AdEvent.Type.COMPLETE,(()=>{T=!1,_&&(log(),p.currentTime(0),p.bigPlayButton.show())})),t.addEventListener(google.ima.AdEvent.Type.FIRST_QUARTILE,(()=>{})),t.addEventListener(google.ima.AdEvent.Type.MIDPOINT,(()=>{})),t.addEventListener(google.ima.AdEvent.Type.THIRD_QUARTILE,(()=>{})),t.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,(()=>{})),t.addEventListener(google.ima.AdEvent.Type.SKIPPED,(()=>{})),t.addEventListener(google.ima.AdEvent.Type.ERROR,(()=>{}))})),p.on("adserror",(e=>{p.currentTime(p.currentTime()+1),hideBigRedButton(),p.play(),303===e.data.AdError.data.errorCode&&(canShowAd=!1,localStorage.setItem("ad_error_timestamp",Math.floor((new Date).getTime()/1e3)))})),p.on("AdEvent",((e,t)=>{const o=t.type;log(),"STARTED"===o&&message("AD_START"),"complete"===o&&(element("#ad_label").style.display="none",message("AD_ENDED"),p.controls(!0)),p.one("loadedmetadata",onLoadedMetadata),p.duration=()=>t.duration})),p.el().addEventListener("leavepictureinpicture",(()=>message("DROP_RIGHT_COLUMN_MARGIN"))),window.addEventListener("message",(async e=>{if(allowedOrigins.includes(e.origin))if("PAUSE_PLAYER"===e.data){const e=p.currentTime();p.duration()-e<=2&&p.pause()}else if("PLAY"===e.data)p.play();else if("STATUS"===e.data.action){var t={callback:e.data.callback,isAdvertPlaying:T,isPiP:h(),currentTime:p.currentTime(),duration:p.duration(),isPaused:p.paused(),displayTime:element(".vjs-current-time-display").innerText};message(t)}else if("NEXT_VIDEO"===e.data.action){const t=e.data.nextVideoId;if(upNextSet=!0,log(e.data.currentVideoDuration),log(isDurationOverThreeMinutes(e.data.currentVideoDuration)),t&&isDurationOverThreeMinutes(e.data.currentVideoDuration)){const e=await getVideoData(t);e.video_name=e.video_name.replace('"',""),e&&p.upnext({url:bitchuteServer+"/video/"+t,target:"_parent",poster:e.thumbnail_url,title:e.video_name,duration:e.duration})}}else if("START_TIME"===e.data.action){const t=videoStartTime=Number(e.data.startTime);if(!p)return;p.currentTime(t),p.paused()&&setTimeout((()=>{p.play(),hideBigRedButton()}),300)}else{if(T)return;let{key:t}=e.data;const n=t.startsWith("Arrow");n||(t=t.toLowerCase());const i=element("#vjs-auto-mute"),r=p.currentTime();switch(t){case" ":case"k":p.paused()?(p.play(),hideBigRedButton()):(p.pause(),showBigRedButton());break;case"ArrowUp":i&&i.remove(),p.muted(!1),p.volume(Math.min(p.volume()+.1,1)),log(p.volume());break;case"ArrowDown":p.volume(Math.max(p.volume()-.1,0)),log(p.volume()),0===p.volume()&&p.muted(!0);break;case"ArrowRight":case"l":case"ArrowLeft":case"j":const e=n?5:10;p.currentTime("ArrowRight"==t||"l"==t?Math.min(r+e,p.duration()):Math.max(0,r-e)),log();break;case"m":log(p.volume()),log(p.muted()),i&&i.remove(),p.muted()?p.muted(!1):p.muted(!0);break;case"f":p.isFullscreen()?p.exitFullscreen():p.requestFullscreen();break;case"i":const s=100,l=5e3,d=" Picture-in-Picture (PiP) ";if(void 0===window.pipIntervalId)pipIntervalId=null;else if(pipIntervalId)return;if(!document.pictureInPictureEnabled)return alert("The 'i' hotkey isn't supported by "+(void 0!==isFirefoxPiP?"Firefox":"your browser")+" because it doesn't provide a"+d+"programming interface.");if(showAds&&!g)return void(confirm("Sorry, the"+d+"video window cannot be requested until any initial adverts have played.\n\nPlay video (ad(s)) now?")&&p.play());if(p.isInPictureInPicture())p.exitPictureInPicture(),message("DROP_RIGHT_COLUMN_MARGIN");else{message("SCROLL_COMMENTS");var o=()=>{pipIntervalId&&(pipTotalTime+=s),pipTotalTime>=l?(a(),alert("It has been "+l/1e3+" seconds since you requested the"+d+"video window, but the video details haven't been loaded yet, where browsers do not permit requesting the PIP window beyond this point, so you just need to close this message, and then try pressing the 'i' hotkey again")):p.readyState()>=1?(pipIntervalId&&a(),p.requestPictureInPicture(),p.play()):pipTotalTime||(message("SHOW_WAIT_CURSOR"),document.body.style.cursor="wait",pipIntervalId=setInterval(o,s))},a=()=>{pipIntervalId=clearInterval(pipIntervalId),message("RESTORE_CURSOR"),document.body.style.cursor=""};pipTotalTime=0,o()}break;default:if(t>="0"&&t<="9")p.currentTime(parseInt(t)/10*p.duration()),p.play();else if((","===t||"."===t)&&p.paused()){const e=1/30;p.currentTime(Math.floor(r)+Math.round(r%1/e)*e+e*(","===t?-1:1)+.01)}}}}))};
